# Maintainer: nyfair <nyfair2012@gmail.com>

pkgname=rust
pkgver=1.3.0
pkgrel=1
arch=('x86_64')
pkgdesc='Systems programming language focused on safety, speed and concurrency'
url='http://www.rust-lang.org/'
license=('MIT' 'Apache')
makedepends=('python2' 'tar' 'curl')
source=("http://static.rust-lang.org/dist/rustc-$pkgver-src.tar.gz")
md5sums=('ffb3971cc96eccaf2de202f621fd415f')

build() {
  cd "rustc-$pkgver"
  ./configure --prefix=/usr --disable-docs --release-channel=stable
  make
}

package() {
  cd "rustc-$pkgver"
  sed -i "s/\"libiconv.a\",//" src/etc/make-win-dist.py
  make DESTDIR="${pkgdir}" install
  rm -f $pkgdir/usr/bin/lib*.dll $pkgdir/usr/bin/rustlib/x86_64-pc-windows-gnu/lib/*.dll
}
