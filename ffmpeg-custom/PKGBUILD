# Maintainer: nyfair <nyfair2012@gmail.com>

pkgname=ffmpeg-custom
pkgver=4.0
pkgrel=1
pkgdesc="Complete and free Internet live audio and video solution"
arch=('x86_64')
url="http://ffmpeg.org"
provides=('ffmpeg')
makedepends=('yasm')
license=('LGPL')
source=("http://ffmpeg.org/releases/ffmpeg-$pkgver.tar.xz")
md5sums=('SKIP')

build() {
  HOST=x86_64-w64-mingw32
  CHOST="--build=$HOST --host=$HOST --target=$HOST"

  unset CFLAGS
  cd "${srcdir}/ffmpeg-$pkgver/"
  ./configure prefix=/usr --target-os=mingw32 --arch=x86_64 --disable-debug \
    --disable-stripping --disable-shared --enable-static --disable-doc \
    --enable-gpl --enable-version3 --enable-nonfree \
    --disable-ffplay --disable-ffprobe --disable-avdevice
    make
}

package() {
  cd "${srcdir}/ffmpeg-$pkgver/"
  make DESTDIR="${pkgdir}" install
  rm -rf ${pkgdir}/usr/bin/*.lib ${pkgdir}/usr/share ${pkgdir}/usr/lib ${pkgdir}/usr/include
}
